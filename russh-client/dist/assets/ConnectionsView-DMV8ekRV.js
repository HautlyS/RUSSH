import{d as N,c as S,B as l,E as s,L as $,D as T,F as w,e as o,b as E,K as c,f as J,J as x,G as D,H as L,Q as P,N as R,k as _,O as I,P as A,Z as K,y as W}from"./vue-vendor-CW4dY-Mk.js";import{u as V,a as H,b as X,c as Y,_ as M,d as ee,e as Z,p as B,f as te,g as j}from"./index-C_UVHTrk.js";import{c as O,u as Q,v as U,w as q,Z as ne,E as se,x as oe,P as z,S as re,y as ae,z as ie}from"./ui-vendor-BiLQkvZj.js";import{invoke as F}from"@tauri-apps/api/core";import{isPermissionGranted as le,requestPermission as ce,sendNotification as ue}from"@tauri-apps/plugin-notification";import"./animation-vendor-BhxYwKto.js";const de={class:"flex items-center gap-2"},ge=["title"],fe={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},G=N({__name:"ConnectionStatus",props:{state:{},showLabel:{type:Boolean}},setup(a){const v=a,i=S(()=>{switch(v.state){case"connected":return{color:"bg-green-500",label:"Connected",pulse:!1};case"connecting":return{color:"bg-yellow-500",label:"Connecting",pulse:!0};case"reconnecting":return{color:"bg-orange-500",label:"Reconnecting",pulse:!0};case"error":return{color:"bg-red-500",label:"Error",pulse:!1};default:return{color:"bg-gray-400",label:"Disconnected",pulse:!1}}});return(y,b)=>(o(),l("div",de,[s("span",{class:"relative flex h-2.5 w-2.5",title:i.value.label},[i.value.pulse?(o(),l("span",{key:0,class:T(["animate-ping absolute inline-flex h-full w-full rounded-full opacity-75",i.value.color])},null,2)):$("",!0),s("span",{class:T(["relative inline-flex rounded-full h-2.5 w-2.5",i.value.color])},null,2)],8,ge),a.showLabel?(o(),l("span",fe,w(i.value.label),1)):$("",!0)]))}}),ye=["aria-label"],me={class:"flex items-start justify-between"},ve={class:"flex items-center gap-3"},pe={class:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg","aria-hidden":"true"},be={class:"font-medium text-gray-900 dark:text-white"},he={key:1},xe={class:"text-sm text-gray-500 dark:text-gray-400"},ke={key:0,class:"mt-3 flex flex-wrap gap-1",role:"list","aria-label":"Tags"},we={class:"mt-4 flex items-center gap-2",role:"group","aria-label":"Connection actions"},Ce=["aria-label"],$e=["aria-label"],_e=["aria-label"],Se=["aria-label"],Ee=["aria-label"],De={class:"flex items-start justify-between"},Te={class:"flex items-center gap-3"},Le={class:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg","aria-hidden":"true"},Ne={class:"font-medium text-gray-900 dark:text-white"},Pe={key:1},Be={class:"text-sm text-gray-500 dark:text-gray-400"},Fe={key:0,class:"mt-3 flex flex-wrap gap-1",role:"list","aria-label":"Tags"},Ie={class:"mt-4 flex items-center gap-2",role:"group","aria-label":"Connection actions"},Ve=["aria-label"],Me=["aria-label"],je=["aria-label"],Oe=["aria-label"],Qe=N({__name:"ConnectionCard",props:{profile:{}},emits:["connect","edit","delete"],setup(a,{emit:v}){const i=a,y=v,b=V(),{isMagnetEnabled:g,isDecryptedTextEnabled:m,visualEffects:h}=H(),{isMobile:k,isTouchDevice:u}=X(),d=S(()=>g.value&&!k.value&&!u()),r=S(()=>b.activeConnections.has(i.profile.id)),e=S(()=>b.connectionStates.get(i.profile.id)),t=S(()=>`${i.profile.name} - ${i.profile.username}@${i.profile.host}:${i.profile.port}`),n=S(()=>{const p=e.value?.status;return p==="connected"?"Connected":p==="connecting"?"Connecting":p==="error"?"Connection error":"Disconnected"});return(p,f)=>d.value?(o(),E(Y,{key:0,padding:c(h).magnet.padding,"magnet-strength":c(h).magnet.magnetStrength,"active-transition":"transform 0.2s ease-out","inactive-transition":"transform 0.4s ease-in-out"},{default:J(()=>[s("article",{class:"connection-card bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-shadow","aria-label":t.value,role:"article"},[s("div",me,[s("div",ve,[s("div",pe,[x(c(O),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),s("div",null,[s("h3",be,[c(m)?(o(),E(M,{key:0,text:a.profile.name,speed:c(h).decryptedText.speed,"animate-on":"view","class-name":"text-gray-900 dark:text-white","encrypted-class-name":"text-green-500"},null,8,["text","speed"])):(o(),l("span",he,w(a.profile.name),1))]),s("p",xe,w(a.profile.username)+"@"+w(a.profile.host)+":"+w(a.profile.port),1)])]),x(G,{state:e.value?.status,"aria-label":n.value},null,8,["state","aria-label"])]),a.profile.tags?.length?(o(),l("div",ke,[(o(!0),l(D,null,L(a.profile.tags,C=>(o(),l("span",{key:C,class:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded",role:"listitem"},w(C),1))),128))])):$("",!0),s("div",we,[r.value?(o(),l("button",{key:1,onClick:f[1]||(f[1]=C=>y("connect")),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":`Open terminal for ${a.profile.name}`}," Open Terminal ",8,$e)):(o(),l("button",{key:0,onClick:f[0]||(f[0]=C=>y("connect")),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2","aria-label":`Connect to ${a.profile.name}`},[x(c(Q),{class:"w-4 h-4","aria-hidden":"true"}),f[8]||(f[8]=P(" Connect ",-1))],8,Ce)),s("button",{onClick:f[2]||(f[2]=C=>y("edit")),class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":`Edit ${a.profile.name}`},[x(c(U),{class:"w-4 h-4","aria-hidden":"true"})],8,_e),s("button",{onClick:f[3]||(f[3]=C=>y("delete")),class:"p-2 text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":`Delete ${a.profile.name}`},[x(c(q),{class:"w-4 h-4","aria-hidden":"true"})],8,Se)])],8,ye)]),_:1},8,["padding","magnet-strength"])):(o(),l("article",{key:1,class:"connection-card bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-shadow","aria-label":t.value,role:"article"},[s("div",De,[s("div",Te,[s("div",Le,[x(c(O),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),s("div",null,[s("h3",Ne,[c(m)?(o(),E(M,{key:0,text:a.profile.name,speed:c(h).decryptedText.speed,"animate-on":"view","class-name":"text-gray-900 dark:text-white","encrypted-class-name":"text-green-500"},null,8,["text","speed"])):(o(),l("span",Pe,w(a.profile.name),1))]),s("p",Be,w(a.profile.username)+"@"+w(a.profile.host)+":"+w(a.profile.port),1)])]),x(G,{state:e.value?.status,"aria-label":n.value},null,8,["state","aria-label"])]),a.profile.tags?.length?(o(),l("div",Fe,[(o(!0),l(D,null,L(a.profile.tags,C=>(o(),l("span",{key:C,class:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded",role:"listitem"},w(C),1))),128))])):$("",!0),s("div",Ie,[r.value?(o(),l("button",{key:1,onClick:f[5]||(f[5]=C=>y("connect")),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":`Open terminal for ${a.profile.name}`}," Open Terminal ",8,Me)):(o(),l("button",{key:0,onClick:f[4]||(f[4]=C=>y("connect")),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2","aria-label":`Connect to ${a.profile.name}`},[x(c(Q),{class:"w-4 h-4","aria-hidden":"true"}),f[9]||(f[9]=P(" Connect ",-1))],8,Ve)),s("button",{onClick:f[6]||(f[6]=C=>y("edit")),class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":`Edit ${a.profile.name}`},[x(c(U),{class:"w-4 h-4","aria-hidden":"true"})],8,je),s("button",{onClick:f[7]||(f[7]=C=>y("delete")),class:"p-2 text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":`Delete ${a.profile.name}`},[x(c(q),{class:"w-4 h-4","aria-hidden":"true"})],8,Oe)])],8,Ee))}}),Ue={class:"connection-list"},qe={key:0,class:"p-4 text-center text-gray-500 dark:text-gray-400"},ze={key:0},Ge={key:1},Re=["onDrop"],Ae=N({__name:"ConnectionList",props:{filter:{},showFolders:{type:Boolean}},emits:["select","connect","edit","delete"],setup(a,{emit:v}){const i=V(),y=a,b=v,g=S(()=>{let u=i.profiles;if(y.filter){const d=y.filter.toLowerCase();u=u.filter(r=>r.name.toLowerCase().includes(d)||r.host.toLowerCase().includes(d)||r.username.toLowerCase().includes(d))}return u}),m=S(()=>{if(!y.showFolders)return{"":g.value};const u={};for(const d of g.value){const r=d.folder||"";u[r]||(u[r]=[]),u[r].push(d)}return u});function h(u,d){u.dataTransfer?.setData("profile-id",d.id)}function k(u,d){const r=u.dataTransfer?.getData("profile-id");r&&i.moveToFolder(r,d)}return(u,d)=>(o(),l("div",Ue,[g.value.length===0?(o(),l("div",qe,[a.filter?(o(),l("p",ze,'No connections match "'+w(a.filter)+'"',1)):(o(),l("p",Ge,"No connections yet"))])):$("",!0),(o(!0),l(D,null,L(m.value,(r,e)=>(o(),l(D,{key:e},[a.showFolders&&e?(o(),l("div",{key:0,class:"folder-header px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",onDragover:d[0]||(d[0]=R(()=>{},["prevent"])),onDrop:t=>k(t,e)},w(e),41,Re)):$("",!0),(o(!0),l(D,null,L(r,t=>(o(),E(ee,{key:t.id,profile:t,draggable:"true",onDragstart:n=>h(n,t),onClick:n=>b("select",t),onConnect:n=>b("connect",t),onEdit:n=>b("edit",t),onDelete:n=>b("delete",t)},null,8,["profile","onDragstart","onClick","onConnect","onEdit","onDelete"]))),128))],64))),128))]))}});function He(a){const v=Z(),i=_(!1),y=_(!1),b=_(null),g=_(null),m=_("");async function h(d){y.value=!0,g.value=null;try{const r=await F("ssh_connect",{request:d});return m.value=r.sessionId,v.success("Connected",`Connected to ${d.host}`),r.sessionId}catch(r){const e=B(r);throw g.value=e.message,v.error("Connection Failed",e.message),r}finally{y.value=!1}}async function k(d,r){i.value=!0,g.value=null;try{const e=await F("ssh_execute",{request:{sessionId:m.value,command:d,timeoutSecs:r}});return b.value=e,e}catch(e){const t=B(e);throw g.value=t.message,v.error("Command Failed",t.message),e}finally{i.value=!1}}async function u(){try{await F("ssh_disconnect",{sessionId:m.value}),v.info("Disconnected","SSH session closed")}catch(d){const r=B(d);throw v.error("Disconnect Failed",r.message),d}}return{isExecuting:i,isConnecting:y,lastResult:b,error:g,sessionId:m,connect:h,execute:k,disconnect:u}}function Ze(){const a=Z(),v=te();async function i(e,t,n,p){const f=v.settings.notifications;f.enabled&&(a.addNotification(e,t,n,{action:p?.action,autoClose:e!=="error"}),p?.sound&&f.sound&&b(),p?.system&&!document.hasFocus()&&await y(t,n))}async function y(e,t){try{let n=await le();n||(n=await ce()==="granted"),n&&ue({title:e,body:t})}catch(n){console.error("Failed to send system notification:",n)}}function b(){try{const e=new AudioContext,t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.frequency.value=800,t.type="sine",n.gain.setValueAtTime(.1,e.currentTime),n.gain.exponentialRampToValueAtTime(.01,e.currentTime+.1),t.start(e.currentTime),t.stop(e.currentTime+.1)}catch{}}function g(e,t,n){return i("success",e,t,{action:n})}function m(e,t,n){return i("error",e,t,{action:n,system:!0})}function h(e,t,n){return i("info",e,t,{action:n})}function k(e,t,n){return i("warning",e,t,{action:n})}function u(e){v.settings.notifications.connectionEvents&&g("Connected",`Successfully connected to ${e}`)}function d(e){v.settings.notifications.connectionEvents&&m("Connection Lost",`Lost connection to ${e}`,{label:"Reconnect",handler:()=>{document.dispatchEvent(new CustomEvent("reconnect-request",{detail:{host:e}}))}})}function r(e,t){v.settings.notifications.transferComplete&&g(t==="upload"?"Upload Complete":"Download Complete",`${e} transferred successfully`)}return{notify:i,success:g,error:m,info:h,warning:k,connectionEstablished:u,connectionLost:d,transferComplete:r}}const Je={class:"quick-connect p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Ke={class:"flex items-center gap-2 mb-4"},We={key:0,class:"mt-1 text-xs text-red-500"},Xe={class:"relative"},Ye=["type"],et={class:"flex gap-2"},tt=["disabled"],nt=N({__name:"QuickConnect",emits:["connected","cancel"],setup(a,{emit:v}){const i=v,{connect:y,isConnecting:b}=He(),{error:g}=Ze(),m=_(""),h=_(""),k=_(!1),u=S(()=>{const e=m.value.trim().match(/^([^@]+)@([^:]+)(?::(\d+))?$/);return e?{username:e[1],host:e[2],port:parseInt(e[3]||"22",10),valid:!0}:{username:"",host:"",port:22,valid:!1}});async function d(){if(!u.value.valid){g("Invalid Format","Use format: user@host or user@host:port");return}try{const r=await y({host:u.value.host,port:u.value.port,username:u.value.username,authMethod:"password",password:h.value});r&&i("connected",r)}catch(r){g("Connection Failed",String(r))}}return(r,e)=>(o(),l("div",Je,[s("div",Ke,[x(c(ne),{class:"w-5 h-5 text-yellow-500"}),e[4]||(e[4]=s("h3",{class:"font-medium text-gray-900 dark:text-white"},"Quick Connect",-1))]),s("form",{onSubmit:R(d,["prevent"]),class:"space-y-3"},[s("div",null,[I(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),type:"text",placeholder:"user@host:port",class:T(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",{"border-green-500":u.value.valid&&m.value}])},null,2),[[A,m.value]]),m.value&&!u.value.valid?(o(),l("p",We," Invalid format. Use: user@host or user@host:port ")):$("",!0)]),s("div",Xe,[I(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>h.value=t),type:k.value?"text":"password",placeholder:"Password",class:"w-full px-3 py-2 pr-10 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,Ye),[[K,h.value]]),s("button",{type:"button",onClick:e[2]||(e[2]=t=>k.value=!k.value),class:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600"},[k.value?(o(),E(c(oe),{key:1,class:"w-4 h-4"})):(o(),E(c(se),{key:0,class:"w-4 h-4"}))])]),s("div",et,[s("button",{type:"submit",disabled:!u.value.valid||c(b),class:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors"},w(c(b)?"Connecting...":"Connect"),9,tt),s("button",{type:"button",onClick:e[3]||(e[3]=t=>i("cancel")),class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Cancel ")])],32)]))}}),st={class:"p-6"},ot={class:"flex items-center justify-between mb-6"},rt={class:"flex gap-2"},at={key:0,class:"mb-6"},it={class:"flex items-center gap-4 mb-6"},lt={class:"relative flex-1 max-w-md"},ct={class:"flex items-center gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1"},ut={key:1,class:"relative"},dt={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},gt={key:3,class:"text-center py-12"},ft={class:"text-gray-500 dark:text-gray-400 mb-4"},xt=N({__name:"ConnectionsView",setup(a){const v=W(),i=V(),{isGradualBlurEnabled:y,visualEffects:b}=H(),g=_(""),m=_("list"),h=_(!1),k=S(()=>{if(!g.value)return i.sortedProfiles;const t=g.value.toLowerCase();return i.sortedProfiles.filter(n=>n.name.toLowerCase().includes(t)||n.host.toLowerCase().includes(t)||n.username.toLowerCase().includes(t))});function u(t){i.connect(t.id)}function d(t){v.push(`/connections/${t.id}/edit`)}async function r(t){confirm(`Delete "${t.name}"?`)&&await i.deleteProfile(t.id)}function e(t){h.value=!1,v.push(`/terminal/${t}`)}return(t,n)=>(o(),l("div",st,[s("div",ot,[n[8]||(n[8]=s("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Connections",-1)),s("div",rt,[s("button",{onClick:n[0]||(n[0]=p=>h.value=!h.value),class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"}," Quick Connect "),s("button",{onClick:n[1]||(n[1]=p=>c(v).push("/connections/new")),class:"btn-primary"},[x(c(z),{class:"w-4 h-4"}),n[7]||(n[7]=P(" New Connection ",-1))])])]),h.value?(o(),l("div",at,[x(nt,{onConnected:e,onCancel:n[2]||(n[2]=p=>h.value=!1)})])):$("",!0),s("div",it,[s("div",lt,[x(c(re),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),I(s("input",{"onUpdate:modelValue":n[3]||(n[3]=p=>g.value=p),type:"text",placeholder:"Search connections...",class:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[A,g.value]])]),s("div",ct,[s("button",{onClick:n[4]||(n[4]=p=>m.value="list"),class:T(["p-2 rounded",m.value==="list"?"bg-white dark:bg-gray-700 shadow-sm":""])},[x(c(ae),{class:"w-4 h-4"})],2),s("button",{onClick:n[5]||(n[5]=p=>m.value="grid"),class:T(["p-2 rounded",m.value==="grid"?"bg-white dark:bg-gray-700 shadow-sm":""])},[x(c(ie),{class:"w-4 h-4"})],2)])]),m.value==="list"?(o(),l("div",ut,[c(y)?(o(),E(j,{key:0,position:"top",height:c(b).gradualBlur.height,strength:c(b).gradualBlur.strength,curve:"bezier",target:"parent",class:"z-10"},null,8,["height","strength"])):$("",!0),x(Ae,{filter:g.value,"show-folders":!0,onConnect:u,onEdit:d,onDelete:r},null,8,["filter"]),c(y)?(o(),E(j,{key:1,position:"bottom",height:c(b).gradualBlur.height,strength:c(b).gradualBlur.strength,curve:"bezier",target:"parent",class:"z-10"},null,8,["height","strength"])):$("",!0)])):(o(),l("div",dt,[(o(!0),l(D,null,L(k.value,p=>(o(),E(Qe,{key:p.id,profile:p,onConnect:f=>u(p),onEdit:f=>d(p),onDelete:f=>r(p)},null,8,["profile","onConnect","onEdit","onDelete"]))),128))])),k.value.length===0?(o(),l("div",gt,[s("p",ft,w(g.value?"No connections match your search":"No connections yet"),1),g.value?$("",!0):(o(),l("button",{key:0,onClick:n[6]||(n[6]=p=>c(v).push("/connections/new")),class:"btn-primary"},[x(c(z),{class:"w-4 h-4"}),n[9]||(n[9]=P(" New Connection ",-1))]))])):$("",!0)]))}});export{xt as default};
