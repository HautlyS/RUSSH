import{a2 as P,k as F,w as K,a as X,d as A,B as x,D as U,b as V,L as J,E as e,K as u,F as T,N as Q,J as m,e as d,c as D,O as B,_ as H,G as I,H as R,P as q,R as ne,o as se,A as le,S as ae}from"./vue-vendor-DVddnRy9.js";import{i as W,l as oe,a as Y,_ as ie,j as ue,k as ce}from"./index-Cz4xlY7J.js";import{x as de,a as ge,b as me,c as ye}from"./xterm-vendor-86Ol6Mvu.js";import{invoke as O}from"@tauri-apps/api/core";import{g as ve,t as be}from"./terminalThemes-B5Ggu4W8.js";import{z as fe,X as Z,T as pe,t as xe,S as ke,J as he,N as Se,D as we,O as Ce,b as Te,P as Fe}from"./ui-vendor-BujFvCZq.js";import{L as $e}from"./Lightning-BL05On8S.js";import"./animation-vendor-D_OJMYL1.js";function ze(){const g=W(),t=P(null),i=P(null),r=P(null),s=F(!1),y=F("");let h=null;async function S(o,c){z();const v=g.settings.terminal;t.value=new de.Terminal({fontFamily:c?.fontFamily||v.fontFamily,fontSize:c?.fontSize||v.fontSize,lineHeight:v.lineHeight,cursorStyle:c?.cursorStyle||v.cursorStyle,cursorBlink:c?.cursorBlink??v.cursorBlink,scrollback:c?.scrollback||v.scrollback,theme:ve(c?.theme||v.theme||"dark"),allowProposedApi:!0}),i.value=new ge.FitAddon,t.value.loadAddon(i.value),r.value=new me.SearchAddon,t.value.loadAddon(r.value);try{const C=new ye.WebglAddon;C.onContextLoss(()=>C.dispose()),t.value.loadAddon(C)}catch{console.warn("WebGL not available, using canvas renderer")}t.value.open(o),i.value.fit(),s.value=!0}async function a(o){if(t.value){y.value=o,t.value.onData(async c=>{try{await O("terminal_input",{sessionId:o,data:c})}catch(v){console.error("Failed to send terminal input:",v)}}),t.value.onResize(async({cols:c,rows:v})=>{try{await O("terminal_resize",{sessionId:o,cols:c,rows:v})}catch(C){console.error("Failed to resize terminal:",C)}}),h=await oe(`terminal-output-${o}`,c=>{t.value?.write(c.payload)});try{await O("terminal_start",{sessionId:o})}catch(c){console.error("Failed to start terminal:",c)}}}function k(o){t.value?.write(o)}function n(){i.value?.fit()}function l(){t.value?.focus()}function w(){t.value?.clear()}function _(){const o=t.value?.getSelection()||"";return o&&navigator.clipboard.writeText(o),o}function N(o){t.value?.paste(o)}function E(o){r.value?.findNext(o)}function $(o){r.value?.findPrevious(o)}function z(){h?.(),h=null,t.value?.dispose(),t.value=null,i.value=null,r.value=null,s.value=!1}return K(()=>g.settings.terminal,o=>{t.value&&(t.value.options.fontFamily=o.fontFamily,t.value.options.fontSize=o.fontSize,t.value.options.lineHeight=o.lineHeight,t.value.options.cursorStyle=o.cursorStyle,t.value.options.cursorBlink=o.cursorBlink,i.value?.fit())},{deep:!0}),X(z),{terminal:t,isReady:s,initTerminal:S,attachToSession:a,write:k,resize:n,focus:l,clear:w,copySelection:_,paste:N,searchNext:E,searchPrevious:$,destroyTerminal:z}}const Be={class:"text-sm truncate max-w-[120px]"},Ae=A({__name:"TerminalTab",props:{id:{},title:{},active:{type:Boolean},hasActivity:{type:Boolean}},emits:["select","close"],setup(g,{emit:t}){const i=t;return(r,s)=>(d(),x("div",{class:U(["terminal-tab flex items-center gap-2 px-3 py-2 cursor-pointer border-b-2 transition-colors",[g.active?"border-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white":"border-transparent hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"]]),onClick:s[1]||(s[1]=y=>i("select"))},[g.hasActivity&&!g.active?(d(),V(u(fe),{key:0,class:"w-2 h-2 text-blue-500 fill-current"})):J("",!0),e("span",Be,T(g.title),1),e("button",{onClick:s[0]||(s[0]=Q(y=>i("close"),["stop"])),class:"p-0.5 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"Close tab"},[m(u(Z),{class:"w-3.5 h-3.5"})])],2))}}),_e={class:"terminal-toolbar flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},Ee={class:"flex items-center gap-2 px-2 text-sm text-gray-600 dark:text-gray-400"},Le={key:1,class:"font-mono"},Ie=A({__name:"TerminalToolbar",props:{hostname:{},connected:{type:Boolean}},emits:["clear","search","settings","split","copy","export","fullscreen"],setup(g,{emit:t}){const i=g,r=t,{isDecryptedTextEnabled:s}=Y(),y=F(!1);F("");const h=D(()=>i.hostname||"Terminal");return(S,a)=>(d(),x("div",_e,[e("div",Ee,[m(u(pe),{class:"w-4 h-4"}),u(s)&&g.connected?(d(),V(ie,{key:0,text:h.value,speed:30,"max-iterations":8,"animate-on":"view",characters:"01","class-name":"text-green-500 font-mono","encrypted-class-name":"text-gray-500 font-mono"},null,8,["text"])):(d(),x("span",Le,T(h.value),1))]),a[7]||(a[7]=e("div",{class:"w-px h-4 bg-gray-300 dark:bg-gray-600 mx-1"},null,-1)),e("button",{onClick:a[0]||(a[0]=k=>r("clear")),class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",title:"Clear terminal (Ctrl+L)"},[m(u(xe),{class:"w-4 h-4"})]),e("button",{onClick:a[1]||(a[1]=k=>{y.value=!y.value,r("search")}),class:U(["p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",{"bg-blue-100 dark:bg-blue-900/30 text-blue-600":y.value}]),title:"Search (Ctrl+F)"},[m(u(ke),{class:"w-4 h-4"})],2),e("button",{onClick:a[2]||(a[2]=k=>r("copy")),class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",title:"Copy selection (Ctrl+Shift+C)"},[m(u(he),{class:"w-4 h-4"})]),a[8]||(a[8]=e("div",{class:"flex-1"},null,-1)),e("button",{onClick:a[3]||(a[3]=k=>r("split")),class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",title:"Split terminal"},[m(u(Se),{class:"w-4 h-4"})]),e("button",{onClick:a[4]||(a[4]=k=>r("export")),class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",title:"Export output"},[m(u(we),{class:"w-4 h-4"})]),e("button",{onClick:a[5]||(a[5]=k=>r("fullscreen")),class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",title:"Fullscreen (F11)"},[m(u(Ce),{class:"w-4 h-4"})]),e("button",{onClick:a[6]||(a[6]=k=>r("settings")),class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",title:"Terminal settings"},[m(u(Te),{class:"w-4 h-4"})])]))}}),Re={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4"},Ue={class:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700"},De={class:"p-4 space-y-4"},Ve=["value"],Ne={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},je=["value"],Me=["value"],Pe={class:"flex items-center justify-between"},He={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Oe={class:"flex items-center justify-between px-4 py-3 border-t border-gray-200 dark:border-gray-700"},Je={class:"flex gap-2"},We=A({__name:"TerminalSettings",props:{visible:{type:Boolean}},emits:["close","apply"],setup(g,{emit:t}){const i=t,r=W(),s=F({fontFamily:r.settings.terminal.fontFamily,fontSize:r.settings.terminal.fontSize,theme:r.settings.terminal.theme,cursorStyle:r.settings.terminal.cursorStyle,cursorBlink:r.settings.terminal.cursorBlink,scrollback:r.settings.terminal.scrollback}),y=["JetBrains Mono","Fira Code","Source Code Pro","Cascadia Code","Consolas","Monaco","monospace"],h=["block","underline","bar"];function S(){r.updateSettings({terminal:{...s.value}}),i("apply")}function a(){s.value={fontFamily:"JetBrains Mono",fontSize:14,theme:"dark",cursorStyle:"block",cursorBlink:!0,scrollback:1e4}}return(k,n)=>(d(),V(ne,{to:"body"},[g.visible?(d(),x("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:n[8]||(n[8]=Q(l=>i("close"),["self"]))},[e("div",Re,[e("div",Ue,[n[9]||(n[9]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Terminal Settings",-1)),e("button",{onClick:n[0]||(n[0]=l=>i("close")),class:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[m(u(Z),{class:"w-5 h-5 text-gray-500"})])]),e("div",De,[e("div",null,[n[10]||(n[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Font Family",-1)),B(e("select",{"onUpdate:modelValue":n[1]||(n[1]=l=>s.value.fontFamily=l),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg"},[(d(),x(I,null,R(y,l=>e("option",{key:l,value:l},T(l),9,Ve)),64))],512),[[H,s.value.fontFamily]])]),e("div",null,[e("label",Ne," Font Size: "+T(s.value.fontSize)+"px ",1),B(e("input",{"onUpdate:modelValue":n[2]||(n[2]=l=>s.value.fontSize=l),type:"range",min:"10",max:"24",class:"w-full"},null,512),[[q,s.value.fontSize,void 0,{number:!0}]])]),e("div",null,[n[11]||(n[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Theme",-1)),B(e("select",{"onUpdate:modelValue":n[3]||(n[3]=l=>s.value.theme=l),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg"},[(d(!0),x(I,null,R(u(be),(l,w)=>(d(),x("option",{key:w,value:w},T(w.charAt(0).toUpperCase()+w.slice(1)),9,je))),128))],512),[[H,s.value.theme]])]),e("div",null,[n[12]||(n[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Cursor Style",-1)),B(e("select",{"onUpdate:modelValue":n[4]||(n[4]=l=>s.value.cursorStyle=l),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg"},[(d(),x(I,null,R(h,l=>e("option",{key:l,value:l},T(l.charAt(0).toUpperCase()+l.slice(1)),9,Me)),64))],512),[[H,s.value.cursorStyle]])]),e("div",Pe,[n[13]||(n[13]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Cursor Blink",-1)),e("button",{onClick:n[5]||(n[5]=l=>s.value.cursorBlink=!s.value.cursorBlink),class:U(["relative w-11 h-6 rounded-full transition-colors",s.value.cursorBlink?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"])},[e("span",{class:U(["absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform",{"translate-x-5":s.value.cursorBlink}])},null,2)],2)]),e("div",null,[e("label",He," Scrollback Lines: "+T(s.value.scrollback.toLocaleString()),1),B(e("input",{"onUpdate:modelValue":n[6]||(n[6]=l=>s.value.scrollback=l),type:"range",min:"1000",max:"100000",step:"1000",class:"w-full"},null,512),[[q,s.value.scrollback,void 0,{number:!0}]])])]),e("div",Oe,[e("button",{onClick:a,class:"px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Reset to Defaults "),e("div",Je,[e("button",{onClick:n[7]||(n[7]=l=>i("close")),class:"px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Cancel "),e("button",{onClick:S,class:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"}," Apply ")])])])])):J("",!0)]))}}),Ge={class:"terminal-container flex flex-col h-full bg-gray-900 relative"},qe={key:0,class:"absolute inset-0 z-0 opacity-30"},Ke={class:"relative z-10 flex items-center bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},Xe={class:"flex-1 flex items-center overflow-x-auto"},Qe=A({__name:"TerminalContainer",props:{sessionId:{}},setup(g){const t=g,i=ue(),r=W(),{isLightningEnabledFor:s,visualEffects:y}=Y(),h=s("terminal"),S=F(),a=F(!1),{terminal:k,initTerminal:n,destroyTerminal:l,clear:w,focus:_,copySelection:N}=ze(),E=D(()=>i.activeTab),$=D(()=>i.tabs);K([()=>E.value,S],async([b,f])=>{b&&f&&(await le(),n(f,{fontSize:r.settings.terminal.fontSize,fontFamily:r.settings.terminal.fontFamily,theme:r.settings.terminal.theme,cursorStyle:r.settings.terminal.cursorStyle,cursorBlink:r.settings.terminal.cursorBlink,scrollback:r.settings.terminal.scrollback}))},{immediate:!0}),se(()=>{t.sessionId&&$.value.length===0&&i.createTab(t.sessionId,t.sessionId,"Terminal")}),X(()=>{l()});function z(){t.sessionId&&i.createTab(t.sessionId,t.sessionId,`Terminal ${$.value.length+1}`)}function o(b){i.closeTab(b)}function c(b){i.setActiveTab(b)}function v(){w()}function C(){N()}function ee(){const b=k.value?.buffer.active;if(b){const f=[];for(let M=0;M<b.length;M++){const G=b.getLine(M);G&&f.push(G.translateToString())}const p=new Blob([f.join(`
`)],{type:"text/plain"}),L=URL.createObjectURL(p),j=document.createElement("a");j.href=L,j.download=`terminal-${Date.now()}.txt`,j.click(),URL.revokeObjectURL(L)}}function te(){const b=S.value?.parentElement;b&&(document.fullscreenElement?document.exitFullscreen():b.requestFullscreen())}function re(){a.value=!1,S.value&&(l(),n(S.value,{fontSize:r.settings.terminal.fontSize,fontFamily:r.settings.terminal.fontFamily,theme:r.settings.terminal.theme,cursorStyle:r.settings.terminal.cursorStyle,cursorBlink:r.settings.terminal.cursorBlink,scrollback:r.settings.terminal.scrollback}))}return(b,f)=>(d(),x("div",Ge,[u(h)?(d(),x("div",qe,[m($e,{hue:u(y).lightning.hue,intensity:u(y).lightning.intensity,speed:u(y).lightning.speed,size:1},null,8,["hue","intensity","speed"])])):J("",!0),e("div",Ke,[e("div",Xe,[(d(!0),x(I,null,R($.value,p=>(d(),V(Ae,{key:p.id,id:p.id,title:p.title,active:p.id===E.value?.id,onSelect:L=>c(p.id),onClose:L=>o(p.id)},null,8,["id","title","active","onSelect","onClose"]))),128))]),e("button",{onClick:z,class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"New tab"},[m(u(Fe),{class:"w-4 h-4"})])]),m(Ie,{class:"relative z-10",onClear:v,onSearch:()=>{},onSettings:f[0]||(f[0]=p=>a.value=!0),onSplit:()=>{},onCopy:C,onExport:ee,onFullscreen:te}),e("div",{ref_key:"terminalRef",ref:S,class:"flex-1 p-2 relative z-10",onClick:f[1]||(f[1]=(...p)=>u(_)&&u(_)(...p))},null,512),m(We,{visible:a.value,onClose:f[2]||(f[2]=p=>a.value=!1),onApply:re},null,8,["visible"])]))}}),Ye=ce(Qe,[["__scopeId","data-v-ae51866c"]]),Ze={class:"h-full"},it=A({__name:"TerminalView",setup(g){const t=ae(),i=D(()=>t.params.sessionId);return(r,s)=>(d(),x("div",Ze,[m(Ye,{"session-id":i.value},null,8,["session-id"])]))}});export{it as default};
